# POWERUp2019 Node.js Workshop

## Express.js

* ~~Intro to Node Webservers~~
* ~~EXTREMELY basic node server on repl.it~~
* Redo with Express & one defined route
* HTTP overview (verbs, query, params, body...)
* Install packages and add them to Express: Morgan, BodyParser, CORS
* Add a POST route so they actually use BodyParser and see its benefits
* Install SQLite and add our SQLite module & connect to their POST route
* Add CRUD routes for one database table using the SQLite module

### Intro to Node Webservers

Now that we've covered the basics of JavaScript and Node.js, we're going to apply those technologies to a common use-case: building a webserver. Webservers built with JavaScript are single-threaded and typically _stateless_, meaning they handle individual messages from clients one-at-a-time, respond, and then completely forget the client ever existed. A typical conversation (API call) between a client and a JavaScript webserver goes like this:

* Client sends an HTTP message to the Server
* Server receives the message and passes it through a series of sequential functions called _middlewares_
* Middlewares process the message in order, until finally a response is generated and sent to the client
* Client receives HTTP response and closes the connection
* Server forgets the client ever existed (does not store client information)

Building a basic webserver with Node.js so simple, you can actually do it in just _one line of code_! To make things clearer, we're going to do it in 6 lines, but give the one-line server a try if you want!

### Hello, Internet!

Open up your editor and enter the code below into the `index.js` file. We'll dissect the code in a moment.

```javascript
const http = require('http'); // import Node's built-in http library

// Create our "application"
const app = function(request, response) {
    response.end('Hello Internet!'); // Send back the string "Hello Internet!" to clients whenever they talk to our server
};

const server = http.createServer(app); // Create a basic web server using our application

server.listen(); // Tell the server to start listening for messages
```

Once you've copied the code, hit `run`. After a few seconds, your server should now be listening for messages.

To test your server, copy the URL at the top of the **Console** section of the editor and open it up in a new tab in your web browser. If all goes well, you should see "Hello Internet!" displayed on a blank page.


**If you need help** call a member of our staff over - we're going to build up this server, so it's important that you have it working here before we move on.


Now that we have our basic server running, let's go through each line of the program:

* `const http = require('http');` - As you may recognize from our JavaScript section, this line creates a variable called `http` and assigns it to the output of running `require('http')`. `require` is a built-in Node.js function for importing modules from other files, and the `'http'` module is a built-in Node.js module. Importing it here allows us to access its functions from our `http` variable.
* `const app = function(request, response) { ... };` - This line creates a function which takes two parameters: `request` and `response` and stores the function in the variable `app`. When our Node server receives a message, it will automatically generate a `Request` object using the data from the message it received, and a `Response` object for us to use to send data back. It will run our function and pass the `Request` object as the first parameter to the function and the `Response` object as the second parameter. The names of the parameters do not affect the server - we use the names `request` and `response` to help us remember which is which.
* `response.end('Hello Internet!');` - Our Node server will run the function we give it whenever it receives a message, but what do we want the server to send back to the client that contacted it? The `Response` object includes several properties and functions that we can use for this. One of those is the function `response.end()`, which can be used to immediately send a message back to the client and close the connection. Our line of code here tells Node to add `'Hello Internet!'` to our response message, send it to the client, and close the connection. That's why when your visit your server in your web browser, your web browser immediately receives and displays 'Hello Internet!' on the page.
* `const server = http.createServer(app);` - Node doesn't just _know_ that we want it to use our `app` function when it receives requests. We have to tell it to do that. This line of code tells the `http` module to create a webserver _which uses our `app` function_, and store it in the `server` variable.
* `server.listen();` - This line starts the server and tells it to begin listening for and responding to messages.



**Note:** the one-line webserver from before looks like this: `require('http').createServer((request, response) => response.end("Hello Internet!")).listen();`. This is a fully functional Node.js webserver in just one line of code.