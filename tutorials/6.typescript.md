# **POWERUp2019 Node.js Workshop**

## **TypeScript**

### **Table of Contents**

* [Introduction](#introduction)
* [Setup](#setup)
* [Your First TypeScript Program](#your-first-typescript-program)
* [TypeScript Variables](#typescript-variables)
* [TypeScript Functions](#typescript-functions)
* [TypeScript Classes](#typescript-classes)
* [Conclusions](#conclusions)

---

### **Introduction**


JavaScript is a weakly-typed language, meaning that variables can be Numbers one minute, Strings another, and Booleans another. Additionally, when you pass values to functions through parameters, no type-checking is done by the engine, and in fact you can pass more of fewer parameters than the function requires (although this could potentially cause runtime errors).

While these language features can be great for writing simple scripts or small programs, they can be a real headache for developing enterprise-level software with large development teams. Unless your documentation is robust, other developers will need to study code before they can be comfortable using functions or classes developed using JavaScript. Furthermore, doing object-oriented development in JavaScript can be a real chore, forcing you to call a number of functions in order to do simple things like extending a superclass or implementing an interface.

To remedy these issues, Microsoft developed TypeScript, superset of JavaScript that features not only strongly-typed variables and function parameters, but also enables object-oriented programming techniques and syntax similar to Java or C#. TypeScript is a true superset of JavaScript in that all JavaScript is valid TypeScript. This allows you to use TypeScript only as much as you want, and JavaScript everywhere else! However, because Node.js doesn't know how to read TypeScript, our TypeScript code must be _transpiled_ into JavaScript before it can be run.

Below we will go through the steps of setting up TypeScript, basic TypeScript syntax, how to transpile to JavaScript, and how to use TypeScript to write code that will make much more maintainable programs. We are sure you will see the value of developing using TypeScript.

---

### **Setup**

Naturally, the first step in setting up typescript is to install it. The official Typescript compiler is available on NPM under the name `typescript`. Use the following command to install it globally (not just for this project, but any future project as well):

```bash
npm install typescript -g
```

Once the installation has completed, check the installed version:

```bash
tsc --version
```

You should see a version number like `3.4.5` as the output from this command. The version does not need to be exact - any version beginning with `3` should be sufficient for this lab.

Now that we've installed Typescript, we need to configure it. The Typescript compiler has a ridiculous number of configuration options so that you can tweak it to the exact environment you want. Let's create a Typescript configuration file, `tsconfig.json`, to set the options. We can do this easily with the following command:

```bash
tsc --init
```

This command will create a `tsconfig.json` file in your current directory with lots of disabled options. We'll leave it as-is for now.

With that done, you should be set up to develop with Typescript - onward!

---

### **Your First TypeScript Program**

For our first program in TypeScript, we are going to simply write JavaScript! That might seem weird, but it is to demonstrate some of the benefits of Typescript.

Say we have a function `greeter` which accepts a person's name and outputs a greeting message to the console. Create a file called `greeter.ts` in the same folder as your `tsconfig.json` file and put the following code into it:

```TypeScript
function greeter(person) {
    console.log("Hello, " + person);
}

let user = "Jane User";
greeter(user);
```

We can compile and run this code in two steps:

```bash
tsc
```

This command will compile all of the `.ts` files in the current directory using the settings in `tsconfig.json`. Typescript will generate a runnable JavaScript version of our program named `greeter.js`, so we can run that using Node:

```bash
node greeter.js
```

When you run this program, you should see 'Hello, Jane User' outputted to the console as expected.

But now let's say that another developer is assigned to our project. They are rushing to meet a deadline, and with a simple and very common misunderstanding, they use the wrong format for the name to greet:

```TypeScript
function greeter(person) {
    console.log("Hello, " + person);
}

let user = {
    name: 'Jane User'
};
greeter(user);
```

When you run this, you should see `Hello, [object Object]` - not exactly the intended output! However, JavaScript does not provide any type-checking, so unless you explicitly test this code, you will not know about this bug until some unsuspecting user encounters it! Luckily, we can use Typescript to avoid this issue altogether by defining the type of the `person` argument to the `greeter` function:

```TypeScript
function greeter(person: string) {
    console.log("Hello, " + person);
}

let user = {
    name: 'Jane User'
};
greeter(user);
```

Now compile this again with the `tsc` command. You should see some angry output that looks a little like this, saying that you cannot send in an `object` as the argument to the `greeter` function since `greeter` requires a `string`:

```bash
index.ts:8:9 - error TS2345: Argument of type '{ name: string; }' is not assignable to parameter of type 'string'.

8 greeter(user);
          ~~~~


Found 1 error.
```

Now, we have caught the error before the code is shipped and saved everyone a lot of headaches. Let's change the `user` variable to correctly store a `string`:

```TypeScript
function greeter(person: string) {
    console.log("Hello, " + person);
}

let user = 'Jane User';
greeter(user);
```

This time, you should not see any output from the `tsc` command, because there are no errors in this code. Running the code now with `node index.js` should correctly output `Hello, Jane User`.

As with all good things though, there are a few hiccups to be aware of.

---

### **TypeScript Variables**

In TypeScript, variables can be given explicit types (hence where they got the name!). **Any value that is stored in the variable must be of the type that the variable is assigned to**. This is unlike JavaScript, where variables can be reassigned at will.

TypeScript types include all of the primitive types available in JavaScript (`number`, `string`, `boolean`, etc.), some extended built-in classes like `tuple` (basically two values of pre-defined types), as well as user-defined types (classes, enums). Additionally, to enable JavaScript-like behavior of being able to assign any value to a variable, you can use the type `any`. If no type is given to a variable, then it is assumed to be `any`.

You can also use typing with containers likes arrays or Maps. This allows you to dictate what types of values are allowed in your container.

To declare the type of a variable, simply add a colon followed by the type after the variable name declaration.

``variables.ts``

```TypeScript
{ // wrap in a block to prevent global namespace clashes...
  // declare our variables
  let name: string = 'Constantine';
  let isActive: boolean = false;
  let scores: number[] = [97, 85.3, 93, 77.8];

  // try to change name to an incorrect value
  name = 24;
}
```

If you are using VS Code as recommended, or any IDE that has static analysis of TypeScript, you should see a warning under the reassignment of `name`, indicating that you cannot assign a number to a variable typed to string.

If we were to compile this program anyway, we should get an error:
```
$ tsc variables.ts
variables.ts:6:3 - error TS2322: Type '24' is not assignable to type 'string'.

6   name = 24;
    ~~~~


Found 1 error.

```

Typing in TypeScript allows you to know for certain what values your variables hold. This greatly improves code readability and maintainability, and allows developers to remove many explicit type checks that are common in JavaScript. As we will see in the next tutorial, you can also create your own classes to essentially extend the native types to be anything you want.

For more information about TypeScript types, consult the TypeScript Handbook pages for [Basic Types](https://www.typescriptlang.org/docs/handbook/basic-types.html) and [Advanced Types](https://www.typescriptlang.org/docs/handbook/advanced-types.html).

---

### **TypeScript Functions**

---

### **TypeScript Classes**

Although JavaScript in the ES6 specification offers support for class syntax like `class` and `extends`, it lacks many features like true abstract class hierachies, `public`/`private`/`protected` members, and more. Luckily, TypeScript enables you to create classes in an object-oriented manner similar to how you would in Java or C#.

In TypeScript, classes can have members that are either properties or functions. By default, these members are public, meaning that anyone or any object can access them without issue.

Lets create a simple class example to demonstrate the power of class inheritance and abstraction in TypeScript, as well as to demonstrate the power of class member visibility.

// TODO: Animal example, with an Animal abstract class with some private/protected/public variables and functions, and implement it with a few sub classes like Dog and Cat

For more information about TypeScript classes, consult the TypeScript Handbook page for [Classes](https://www.typescriptlang.org/docs/handbook/classes.html).

---

### **Conclusion**

TypeScript is a superset of JavaScript that adds class, interface, and template syntax similar to languages like Java or C#. It also enables strong type-checking for variables and function parameters, ensuring that the data stored in your program and passed between functions is in the format you expect.

JavaScript was originally developed for writing small little scripts to manipulate objects in a web browser; It was never intended for writing entire enterprise-level server-side applications. It prioritized coding speed over maintainability (and sometimes readability), which is fine for small scripts, but becomes a headache when trying to debug an application. TypeScript greatly improves the maintainability and readability of JavaScript, and should be strongly considered by any business interested in developing applications on Node.js.
