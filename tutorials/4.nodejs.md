# POWERUp2019 Node.js Workshop

## **Node.js**

---

### **What is Node.js?**

At its core, Node.js (sometimes just called _Node_) is a JavaScript runtime that executes your JavaScript code using Google's Chrome V8 engine. In the past, JavaScript was primarily run in the browser (many of which run with Chrome V8 engine as well).

The power of Node.js is that it allows you to use JavaScript (an incredibly flexible and easy-to-learn language) to do more than just manipulate HTML and CSS in the browser. Instead, the Node.js runtime environment runs code in an environmnet similar to Java or Python: Directly on your machine with access to the kernel, file system, etc. through environment APIs. It can read and manipulate databases and files, send and receive HTTP messgages over the internet, or call C and C++ programs, just to name a few uses.

You can do nearly everything with Node.js that you are accustomed to doing in C, C++, or RPG. In fact, IBM has developed Node.js packages that allow you to call all of the RPG programs, SQL procedures, CL and QSH commands, and much more that you have invested a lot of time and money in, **allowing Node.js to build on the work that you have already done**. We will talk more about how IBM's packages allow interaction between the Node.js runtime and OS400 more below.

The Node.js runtime is supported by an extremely rich ecosystem of open-source packages which you can use in your applications for free. The **nearly one million freely available packages** include, but are _certainly_ not limited to `http` and `express` to help you easily interact with the internet, `os` to help you interact with your operating system, and `itoolkit` and `xmlservice` to help you easily interact with native programs on the IBM i.

What does this mean for you as a developer? It means that you have a rich library of packages to use in your programs, allowing you to reuse code that has already been written for things like calling or serving HTTP endpoints. This frees you to focus almost exclusively on your own application logic, greatly increasing development time compared to other technologies.

There are important things to know about the Node.js runetime in order to be a successful developer, such as the fact that it is single-threaded (sounds scarier than it is), or that there is an event loop that must be learned to get the most out of the environment. These topics would take too long to cover in this lab, and so have been included at the end of this file as an appendix, but if you are serious about Node.js, come back after to read this section.

Appendix: Important things to Knode // TODO: terrible pun, will remove
// TODO: LINK

---

### **npm: The Node Package Manager**

![alt text](npm.png "Logo Title Text 1")

One of the most compelling reasons to use Node.js is npm, The Node Package Manager. npm is a repository of over 940,000 open-source Node.js packages have been developed by members of the community, and can be found at [https://www.npmjs.com/](https://www.npmjs.com/). This makes npm the largest code repository in the entire world! To browse the packages available, simply visit the website and search in the bar for either the package name or by keywords.

The packages on range in size and scope from single-line functions that do very spcific data testing or manipulation, to entire frameworks for creating web servers and creating API endpoints. Many packages are updated very frequently and have tens of millions of downloads every week. As an example, the most popular package on npm, `lodash`, is a utility library that has 21 million weekly downloads.

Because these packages are open-source, you can go to any package, click on the link to its code repository, and see all of the code that is used to build the package. This allows you 

The best part of npm is that a lot of the boring, hard-to-implement functionality of software has already been done for you, allowing you to focus instead on writing the application logic for your business or project.

---

### **The `npm` utility**

When you download Node.js, in addition to the `node` command you also get the `npm` command. The `npm` utility helps install packages from [https://www.npmjs.com/](https://www.npmjs.com/) and manage the metadata for your program (e.g. version number, author name, specifying scripts, etc.).

When you create a Node.js project, usually the first thing you do is go to your project's directory and running `npm init`. This command will create a file called `package.json` that will store all of the metadata for your application. Although you don't _have_ to run `npm init` or even have a `package.json` to use Node.js, you will have to use it if you want to either

1. Push your package to be available on npm
2. Download any packages from npm using the `npm install` command.

So if `npm init` creates `package.json`, what does `package.json` do?// TODO:
* What is `package.json`
* How to install packages with `npm install`

---

### **IBM i Node.js Packages**

As mentioned above, one of the main benefits of using Node.js is the robust package ecosystem that is available on NPM that allows you to do things out of the box without reinventing the wheel. As part of this ecosystem, The IBM i Open-Source Software Team has developed a number of packages that allow you to interact with your IBM i, either from a Node.js process running directly on your IBM i or a remote process running on a server or your development machine.

* **`itoolkit`**: A package that uses the IBM i XMLSERVICE to enable calls into your IBM i. Some of the things could can do with itoolkit includes calling programs, CL or QSH commands, running SQL, and many more things you are accustomed to doing in 5250. To download, run `npm install itoolkit`. More information about the package can be found at: [https://www.npmjs.com/package/itoolkit](https://www.npmjs.com/package/itoolkit)

* **`idb-connector`**: A database connector that creates a simple API for communicating with Db2 on the IBM i. **idb-connector can only be run on a Node.js instance on the IBM i, not a Node.js instance calling to a remote IBM i.** To download, run `npm install idb-connector`. More information about the package can be found at: [https://www.npmjs.com/package/idb-connector](https://www.npmjs.com/package/idb-connector).

* **`idb-pconnector`**: A wrapper for `idb-pconnector` that converts the API to use native JavaScript `Promises` instead of callback functions, and also comes with connection pooling. **Like `idb-connector`, it can only be run on IBM i**. To download, run `npm install idb-pconnector`. More information about the package can be found at [https://www.npmjs.com/package/idb-pconnector](https://www.npmjs.com/package/idb-pconnector).

* **`odbc`**: Our latest database connector, ODBC is platform (and database management system) agnostic and allows you to connect to your IBM i from any system granted that you have an ODBC driver. It also can be used directly on the IBM i. To download, run `npm install odbc@beta`. Unlike the other packages listed here, this package is not IBM i-specific, and the IBM i Open-Source Software team only recently assumed leadership over the project. However, this package will be the future of database connection on the IBM i, and so it might be best to set up your ODBC environment sooner rather than later. More information about the package can be found at: [https://www.npmjs.com/package/odbc](https://www.npmjs.com/package/odbc).

---

### **Your First (Real) Node.js Application**

Although our previous examples were run using Node.js, lets create an application that actually uses the power of `npm` to download a package
* use `npm init` to create your application
*  Maybe get `request` to request a website or an API, returning the information (or the entire webpage).
* Download a package or two
* require the packages in the main file
* run something interesting using JavaScript skills

---

## **Conclusion**

Node.js may seem confusing at first, but it is really quite simple technology. Node.js itself is nothing more than a runtime that allows you to write programs in JavaScript, a weakly-typed and interpreted language, while also exposing access to things like the file system and http methods.

The real power of Node.js comes from the hundreds of thousands of open-source packages hosted on npmjs.com that allow you to use someone else's hard work to implement functionality in your program. This allows you to focus primarily on your business logic and not on reinventing the wheel.

IBM has invested money and development resources not just in making sure that Node.js is an enterprise-level tool, but also so that it has a robust suite of packages to interact with the IBM i. In the next few tutorials, we will create applications that use Db2 on the IBM i as a data store, showing you how to combine the technology you are already comfortable with and the power of Node.js to quickly add value to your business.